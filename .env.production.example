# Production Environment Configuration
# Copy this file to .env.production and update with your actual values
# IMPORTANT: Never commit .env.production to version control

# ===================================
# Server Configuration
# ===================================
SERVER_PORT=8080
ENVIRONMENT=production

# ===================================
# CORS Configuration
# ===================================
# IMPORTANT: Set this to your actual frontend domain(s)
# Multiple origins separated by commas
CORS_ALLOWED_ORIGINS=https://app.yourdomain.com,https://www.yourdomain.com

# ===================================
# Database Configuration
# ===================================
# Production database connection string
# For AWS RDS: postgresql://username:password@db-instance.region.rds.amazonaws.com:5432/portfolios?sslmode=require
# For DigitalOcean: postgresql://username:password@db-cluster.region.db.ondigitalocean.com:25060/portfolios?sslmode=require
# For self-hosted: postgresql://username:password@db-host:5432/portfolios?sslmode=require
DATABASE_URL=postgresql://portfolios_user:STRONG_PASSWORD_HERE@db-host:5432/portfolios?sslmode=require

# ===================================
# JWT Configuration
# ===================================
# CRITICAL: Generate a cryptographically secure secret
# Run this command to generate: openssl rand -base64 64
# Minimum 64 characters, use the full output
JWT_SECRET=REPLACE_WITH_64_CHAR_RANDOM_SECRET_GENERATED_BY_OPENSSL_RAND_BASE64_64

# Token expiration times
# Access token: How long the user stays logged in before needing refresh (60 minutes = 1 hour)
JWT_ACCESS_TOKEN_DURATION=60m

# Refresh token: How long before user must log in again (168 hours = 7 days)
JWT_REFRESH_TOKEN_DURATION=168h

# Remember Me access token: Extended access token duration (24 hours = 1 day)
JWT_REMEMBER_ME_ACCESS_DURATION=24h

# Remember Me refresh token: Extended refresh token duration (720 hours = 30 days)
JWT_REMEMBER_ME_REFRESH_DURATION=720h

# ===================================
# SMTP Configuration (Production Email Service)
# ===================================
# Choose one of the following email service providers

# --- Option 1: SendGrid ---
# SMTP_HOST=smtp.sendgrid.net
# SMTP_PORT=587
# SMTP_USERNAME=apikey
# SMTP_PASSWORD=YOUR_SENDGRID_API_KEY
# SMTP_FROM=noreply@yourdomain.com

# --- Option 2: AWS SES ---
# SMTP_HOST=email-smtp.us-east-1.amazonaws.com
# SMTP_PORT=587
# SMTP_USERNAME=YOUR_AWS_SMTP_USERNAME
# SMTP_PASSWORD=YOUR_AWS_SMTP_PASSWORD
# SMTP_FROM=noreply@yourdomain.com

# --- Option 3: Mailgun ---
# SMTP_HOST=smtp.mailgun.org
# SMTP_PORT=587
# SMTP_USERNAME=postmaster@mg.yourdomain.com
# SMTP_PASSWORD=YOUR_MAILGUN_SMTP_PASSWORD
# SMTP_FROM=noreply@yourdomain.com

# --- Option 4: Gmail (not recommended for production) ---
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USERNAME=your-email@gmail.com
# SMTP_PASSWORD=your-app-specific-password
# SMTP_FROM=your-email@gmail.com

# Default configuration (update with your chosen provider)
SMTP_HOST=smtp.sendgrid.net
SMTP_PORT=587
SMTP_USERNAME=apikey
SMTP_PASSWORD=YOUR_SENDGRID_API_KEY_HERE
SMTP_FROM=noreply@yourdomain.com

# ===================================
# Rate Limiting Configuration
# ===================================
# Protects against brute force attacks
# 5 requests per minute is recommended for authentication endpoints
RATE_LIMIT_REQUESTS=5
RATE_LIMIT_DURATION=1m

# ===================================
# Security Notes
# ===================================
#
# 1. JWT_SECRET:
#    - MUST be at least 64 characters
#    - Generate with: openssl rand -base64 64
#    - Keep this secret secure - anyone with this can forge tokens
#    - NEVER commit this to version control
#    - Rotate periodically (will invalidate all existing tokens)
#
# 2. Database Password:
#    - Use a strong password (16+ characters, mixed case, numbers, symbols)
#    - Different from any other passwords
#    - Store securely (password manager, secrets manager)
#
# 3. SMTP Password:
#    - Use service-specific API keys when available
#    - For Gmail, use App-Specific Passwords, not your main password
#    - Restrict API key permissions to sending email only
#
# 4. CORS:
#    - Only include your actual frontend domain(s)
#    - Remove any localhost or development URLs
#    - Match the exact protocol (https://) and domain
#
# 5. SSL/TLS:
#    - Always use sslmode=require for database connections
#    - Ensure SMTP uses TLS (port 587) or SSL (port 465)
#    - Configure HTTPS at the load balancer/reverse proxy level
#
# 6. File Permissions:
#    - Set .env.production to 600 (read/write for owner only)
#    - Command: chmod 600 .env.production
#    - Owned by application user only
#
# 7. Environment Variables:
#    - Consider using secrets management (AWS Secrets Manager, HashiCorp Vault)
#    - For Docker, use docker secrets or environment file
#    - For Kubernetes, use ConfigMaps and Secrets
#
# ===================================
# Quick Setup Commands
# ===================================
#
# 1. Generate JWT Secret:
#    openssl rand -base64 64
#
# 2. Set file permissions:
#    chmod 600 .env.production
#    chown portfolios:portfolios .env.production
#
# 3. Test database connection:
#    psql "$DATABASE_URL"
#
# 4. Test SMTP (requires telnet):
#    telnet smtp.sendgrid.net 587
#
# 5. Validate configuration:
#    go run cmd/api/main.go
#    (should start without errors)
